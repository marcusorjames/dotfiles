###### marcusorjames's tmux config <https://github.com/marcusorjames> ######

### General SettingsÂ ###

# Set prefix to Ctrl+a
unbind C-b
set -g prefix C-a

set -g mouse on
setw -g mode-keys vi # Set vi mode
set -sg escape-time 10 # Reduce escape timeout for vim

# Start windows and panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

set -g renumber-windows on


###  Copy and paste ###

# Set Enter and mouse drag to use copy pipe
unbind -T copy-mode-vi Enter
bind-key -T copy-mode-vi Enter \
    send-keys -X copy-pipe-and-cancel "pbcopy"
bind-key -T copy-mode-vi MouseDragEnd1Pane \
    send-keys -X copy-pipe-and-cancel "pbcopy"

# Drag and Drop Select & Copy (Selection)
bind-key -T copy-mode-vi MouseDragEnd1Pane \
  send-keys -X copy-pipe-and-cancel "xclip -in -f | xclip -in -sel c"
# Double LMB Select & Copy (Word)
bind-key -n DoubleClick1Pane \
  select-pane \; \
  copy-mode -M \; \
  send-keys -X select-word \; \
  run-shell "sleep .2s" \; \
  send-keys -X copy-pipe-and-cancel "xclip -in -f | xclip -in -sel c"
# Triple LMB Select & Copy (Line)
bind-key -n TripleClick1Pane \
  select-pane \; \
  copy-mode -M \; \
  send-keys -X select-line \; \
  run-shell "sleep .2s" \; \
  send-keys -X copy-pipe-and-cancel "xclip -in -f | xclip -in -sel c"


### Rebindings ###

unbind r
bind-key r source-file ~/.config/tmux/tmux.conf \; \
  display-message "~/.config/tmux/tmux.conf reloaded"

# (^A) Cycle through panes with prefix key
unbind ^A
bind ^A select-pane -t :.+

# (S) Create new Session
unbind S
bind-key S new

# (X) Kill Current Session
unbind X
bind-key X confirm-before -p "Kill #S (y/n)?" "run-shell 'tmux switch-client -n \\\; kill-session -t \"#S\"'"

### Plugins ###

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'egel/tmux-gruvbox'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Set theme
set -g @tmux-gruvbox 'dark'

# Restore session when tmux is started
set -g @continuum-restore 'on'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.config/tmux/plugins/tpm/tpm'


### TODO ###
# - Perma sessions

